<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Каталог магазина</title>
</head>
<body class="bg-white text-gray-900">
  <div class="max-w-2xl mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4 text-center text-black">Каталог магазина</h1>

    <div id="categories" class="grid grid-cols-2 gap-4 mb-6"></div>
    <div id="products" class="grid grid-cols-1 gap-6"></div>

    <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
      <div class="bg-white rounded-2xl shadow-lg p-6 w-80">
        <button id="modal-close" class="text-gray-500 hover:text-black float-right">✕</button>
        <img id="modal-img" src="" alt="" class="w-full h-40 object-cover rounded-md mb-4" />
        <h2 id="modal-name" class="text-xl font-semibold mb-2 text-black"></h2>
        <p id="modal-desc" class="text-gray-700 mb-4"></p>
        <div class="flex justify-between items-center">
          <span id="modal-price" class="text-lg font-bold text-black"></span>
          <span id="modal-stock" class="text-sm text-gray-600"></span>
        </div>
      </div>
    </div>
  </div>

  <script>
    const categories = [
      "Жидкости",
      "Табачная продукция",
      "Картриджи",
      "Испарители"
    ];
    let products = [];

    fetch('products.json')
      .then(res => res.json())
      .then(data => {
        products = data;
        renderCategories();
      });

    function renderCategories() {
      const container = document.getElementById('categories');
      container.innerHTML = '';
      categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        btn.className = 'p-4 border-2 border-black rounded-lg text-black hover:bg-black hover:text-white transition';
        btn.onclick = () => renderProducts(cat);
        container.appendChild(btn);
      });
    }

    function renderProducts(category) {
      const container = document.getElementById('products');
      container.innerHTML = '';
      const filtered = products.filter(p => p.category === category);
      filtered.forEach(p => {
        const card = document.createElement('div');
        card.className = 'flex items-center border-2 border-black rounded-lg overflow-hidden';
        card.innerHTML = `
          <img src="${p.image}" alt="${p.name}" class="w-24 h-24 object-cover" />
          <div class="p-4 flex-1">
            <h3 class="font-semibold mb-1 text-black">${p.name}</h3>
            <p class="text-gray-700">${p.price}₽</p>
          </div>
        `;
        card.onclick = () => openModal(p);
        container.appendChild(card);
      });
    }

    function openModal(p) {
      document.getElementById('modal-img').src = p.image;
      document.getElementById('modal-name').textContent = p.name;
      document.getElementById('modal-desc').textContent = p.description;
      document.getElementById('modal-price').textContent = p.price + '₽';
      document.getElementById('modal-stock').textContent = p.stock > 0 ? 'В наличии' : 'Нет в наличии';
      document.getElementById('modal').classList.remove('hidden');
      document.getElementById('modal').classList.add('flex');
    }

    document.getElementById('modal-close').onclick = () => {
      document.getElementById('modal').classList.add('hidden');
      document.getElementById('modal').classList.remove('flex');
    };
  </script>
</body>
</html>